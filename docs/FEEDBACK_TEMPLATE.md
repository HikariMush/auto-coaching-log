# フィードバックテンプレート集

## 📋 この回答の分析

**質問**: 「マリオ対策教えて」

### 回答の評価

| 要素 | 評価 | 改善ポイント |
|------|------|------------|
| [1] フレームデータ | ★★★☆☆ | 上スマ、空N、掴みのデータは良いが、具体的な数値（ダメージ%）が一部欠けている |
| [2] 技術的解説 | ★★★★☆ | ずらしの説明は良い。ガーキャン上スマの計算式（9F+3F=12F）が明記されていない |
| [3] 実戦での使い方 | ★★★☆☆ | 「間合い管理」「着地狩り」は良いが、具体的な技選択が不足 |
| [4] 補足・注意点 | ★★★★☆ | %帯の説明、崖攻防、メンタル面と包括的 |
| トーン | ★★★★★ | 穏やかで客観的、過度に熱血的でない |

**総合評価**: ★★★★☆（良好だが、さらに改善可能）

---

## 🎯 この回答へのフィードバック例

### 改善案1: [1]フレームデータの強化

```
/teach_element question:"マリオ対策教えて" 
               element_number:1 
               correction:"[1]に以下の数値データを追加すべき:
                          
                          **上スマッシュ**
                          - 発生: 9F
                          - ダメージ: 14.0%（地上）
                          - ガーキャン発生: 12F（ジャンプ3F + 上スマ9F）
                          - 撃墜%: 約100-120%（中央）
                          
                          **空中N攻撃**
                          - 発生: 3F
                          - ダメージ: 初段5.0% + 2段目2.6% = 計7.6%
                          - 着地硬直: 7F
                          
                          **掴み**
                          - 発生: 通常6F、ダッシュ8F、振り向き9F
                          - 下投げダメージ: 5.0%
                          - 下投げ→空上の確定%帯: 0-90%程度
                          
                          数値の具体性が対策精度を高めます。"
```

**理由**: 
- フレームだけでなくダメージ%も重要
- ガーキャン上スマの計算式（3F+9F=12F）が学習される
- 確定%帯の情報は対策に不可欠

---

### 改善案2: [2]技術的解説の深掘り

```
/teach_element question:"マリオ対策教えて" 
               element_number:2 
               correction:"[2]に以下の計算・理論を追加:
                          
                          **ガーキャン上スマの計算**
                          ジャンプ発生: 3F
                          上スマ発生: 9F
                          合計: 3F + 9F = 12F
                          
                          → 相手の技がガードされて12F以上の隙があると確定
                          
                          **先端当ての重要性（計算）**
                          例: あなたの技が-10Fだとする
                          先端当て: マリオまでの距離が7マス
                          密着: マリオまでの距離が0マス
                          
                          マリオのガーキャン上スマ（12F）は、
                          密着だと届くが、先端なら届かない可能性が高い
                          
                          **コンボのずらし方向（詳細）**
                          下投げ→空上の場合:
                          - ずらし方向: 後方斜め上（マリオと反対方向の斜め上45度）
                          - 理由: ベクトル変更により、空上の当たり判定から逃れる
                          - 効果: 約30-40%から抜けられる可能性
                          
                          計算式や理論的根拠を示すことで、理解が深まります。"
```

**理由**:
- 計算式を明記（DSPyが「技術的解説には計算式」を学習）
- ずらし方向の理論的根拠を説明
- 数値（距離、角度、%）で具体化

---

### 改善案3: [3]実戦での使い方の具体化

```
/teach_element question:"マリオ対策教えて" 
               element_number:3 
               correction:"[3]に具体的な技選択を3つ以上追加:
                          
                          **間合い管理の具体例**
                          
                          使用キャラがクラウドの場合:
                          1. 空前（発生9F、リーチ優秀）で牽制
                             - マリオの掴み圏外から振る
                             - 当たればダメージ、ガードでも-4Fなので比較的安全
                          
                          2. 横強（発生10F、リーチ長い）で差し込み防止
                             - マリオがダッシュで接近してくる際に置き技として
                             - 先端当てなら反撃を受けにくい
                          
                          3. DA（発生7F）での奇襲は控える
                             - マリオのガーキャン上スマ（12F）に狩られる
                             - 確実に当たる場面以外は使用を避ける
                          
                          **NB（ファイアボール）の処理（具体的）**
                          1. ジャンプで避ける場合: 着地隙を突かれないよう空中攻撃でカバー
                          2. ガードで受ける場合: ずっとガードせず、合間に前進
                          3. 飛び道具で相殺: NB（ファイアボール）より速い弾で打ち消す
                          
                          **着地狩りの具体的手順**
                          1. 上に浮かせる（上投げ、上強、空上など）
                          2. 相手の着地点を予測（中央 or 崖）
                          3. 着地を読んで技を置く（空前、DA、掴みなど）
                          4. マリオの暴れ（空下、下B）を警戒し、ガードも混ぜる
                          
                          抽象的な「間合い管理」ではなく、
                          「どの技を、どの間合いで、どう使うか」を明記すべき。"
```

**理由**:
- 「間合い管理」→ 具体的な技3つ + 使用条件
- 「NB処理」→ 3つの方法 + それぞれの注意点
- 「着地狩り」→ 4段階の手順
- キャラ別の具体例（クラウド）で理解しやすく

---

### 改善案4: トーンの評価（ポジティブフィードバック）

```
/teach question:"マリオ対策教えて"
       correction:"【優れている点】
                   - トーンが穏やかで客観的（「〜することが重要です」「〜を意識してください」）
                   - 命令形を避けている
                   - 「焦らないこと」など心理面にも配慮
                   - デメリット・リスクも説明（「安易に〜は危険」）
                   
                   このトーンを今後も維持してください。
                   
                   【さらに良くする例】
                   「〜を意識してください」
                   → 「〜を意識すると効果的です」「〜をおすすめします」
                   
                   「〜が重要です」
                   → 「〜が有効です」「〜が推奨されます」
                   
                   より柔らかい表現にすることで、さらに穏やかになります。"
```

**理由**:
- ポジティブフィードバックもDSPy学習に有効
- 良いパターンを明示的に強化
- 微細なトーン調整も学習可能

---

## 📝 フィードバックテンプレート

### テンプレート1: 要素別修正（推奨）

```
/teach_element question:"[元の質問]" 
               element_number:[1/2/3/4] 
               correction:"[問題点]
                          
                          [具体的な改善内容]
                          
                          [理由・効果]"
```

**使用例**:
```
/teach_element question:"マリオ対策教えて" 
               element_number:1 
               correction:"上スマのダメージ（14.0%）と撃墜%帯（100-120%）を追加すべき。
                          
                          これにより、どのくらい警戒すべき技かが明確になります。"
```

---

### テンプレート2: 複数要素の統合修正

```
/teach question:"[元の質問]"
       correction:"【改善点】
                   
                   [1] [要素1の改善内容]
                   
                   [2] [要素2の改善内容]
                   
                   [3] [要素3の改善内容]
                   
                   【全体的な改善方向】
                   [統合的な指摘]"
```

**使用例**:
```
/teach question:"マリオ対策教えて"
       correction:"【改善点】
                   
                   [1] 各技のダメージ%を追加（上スマ14%, 空N7.6%など）
                   
                   [2] ガーキャン上スマの計算式を明記（3F+9F=12F）
                   
                   [3] キャラ別の具体的な技選択を追加
                       （例: クラウドなら空前で牽制、横強で差し込み防止）
                   
                   【全体的な改善方向】
                   「間合い管理」などの抽象的な表現を、
                   「どの技を、どの間合いで、どう使うか」という具体例に置き換えるべき。"
```

---

### テンプレート3: パターン学習用

```
/teach question:"[元の質問]"
       correction:"【学習させたいパターン】
                   
                   [このタイプの質問に対する理想的な回答構造]
                   
                   【例】
                   キャラ対策の質問には常に以下を含めるべき:
                   1. 相手の強み（技性能、戦術）
                   2. その強みへの具体的な対処法
                   3. こちらが狙うべき弱点
                   4. キャラ別の推奨技選択
                   5. %帯別の注意点"
```

---

## 🎯 フィードバックすべき具体的ポイント

### この回答（マリオ対策）に対して

#### ポイント1: [1]フレームデータの数値追加
**現状**: 発生Fのみ記載  
**改善**: ダメージ%、撃墜%帯、全体F、硬直差も追加

```
/teach_element question:"マリオ対策教えて" 
               element_number:1 
               correction:"各技にダメージ%と撃墜%帯を追加:
                          - 上スマ: 14.0%、撃墜100-120%
                          - 空N: 7.6%
                          - 下投げ: 5.0%
                          - 空上: 7.0%、撃墜150-170%
                          
                          これにより、各技の脅威度が定量化されます。"
```

#### ポイント2: [2]計算式の明記
**現状**: 「12Fで出せる」とだけ書かれている  
**改善**: 計算過程を明記

```
/teach_element question:"マリオ対策教えて" 
               element_number:2 
               correction:"ガーキャン上スマの計算過程を明記:
                          
                          【計算】
                          1. ガードからジャンプ: 3F
                          2. ジャンプ後に上スマ: 9F
                          3. 合計: 3F + 9F = 12F
                          
                          【結論】
                          相手の技がガードされて12F以上の隙があると、
                          ガーキャン上スマが確定します。
                          
                          【例】
                          クラウドの横Bをガードした場合:
                          横Bの硬直: 20F
                          マリオのガーキャン上スマ: 12F
                          20F > 12F → 確定
                          
                          計算式を示すことで、他の技にも応用できます。"
```

#### ポイント3: [3]技選択の具体化
**現状**: 「間合い管理」「着地狩り」は良いが、どの技を使うかが不明  
**改善**: キャラ別・状況別の技選択を3つ以上提示

```
/teach_element question:"マリオ対策教えて" 
               element_number:3 
               correction:"[3]実戦での使い方に、キャラ別の具体的な技選択を追加:
                          
                          **使用キャラがクラウドの場合**
                          
                          1. 牽制技（間合い管理）
                             - 空前: 発生9F、リーチ優秀、先端ならガーキャン上スマ圏外
                             - 横強: 発生10F、地上での差し込み防止
                             - 回避推奨: DA（ガーキャン上スマに狩られる）
                          
                          2. 着地狩り技
                             - 空上: マリオを浮かせた後、着地点を先読みして置く
                             - 上強: 地上着地を狙う、コンボ始動
                             - 掴み: 最も安定、投げ後の展開も良好
                          
                          3. 復帰阻止技
                             - 空下: リーチが長く、マリオの上Bを潰しやすい
                             - 空後: 横方向の復帰を阻止
                             - 下B（流斬り）: 崖外でのカバー範囲が広い
                          
                          **使用キャラがネスの場合**
                          
                          1. 牽制技
                             - PKファイアー: ファイアボールを上書き、マリオを止める
                             - 空前: 多段技でファイアボールを相殺しながら接近
                          
                          2. 着地狩り技
                             - 空上: 撃墜%でも狙える
                             - 掴み→後ろ投げ: ストック有利時の撃墜択
                          
                          3. 復帰阻止技
                             - 空後: マリオの上B（縦方向）に刺さる
                             - PKサンダー: 崖外での復帰ルート制限
                          
                          **共通の改善パターン**
                          「間合い管理」「着地狩り」などの抽象的な表現は、
                          必ず「どの技を、どの間合いで、どう使うか」を3つ以上の具体例で説明すべき。"
```

**理由**:
- 「間合い管理」だけでは実行できない
- キャラ別に技選択が異なる
- 3つ以上の具体例でDSPyが「実戦的な説明」のパターンを学習

#### ポイント4: [4]補足の深化（初心者配慮）

```
/teach_element question:"マリオ対策教えて" 
               element_number:4 
               correction:"[4]に初心者向けの段階的な学習パスを追加:
                          
                          **初心者が最初に意識すべきこと（優先度順）**
                          
                          1. ガーキャン上スマに狩られない（最優先）
                             - 隙の大きい技（DA、横スマなど）をマリオのガードに当てない
                             - 先端当てを意識
                             - まずはこれだけでも意識すると大きく改善
                          
                          2. 掴まれない
                             - 低〜中%での下投げコンボが最も痛い
                             - ガード多用を避ける、ジャンプで逃げる
                             - ガード読みの掴みに対して、ジャンプ or 攻撃で対処
                          
                          3. 復帰時のルート変化
                             - 毎回同じルートで復帰しない
                             - タイミングをずらす（空中回避で粘る）
                             - これだけで復帰阻止の成功率が下がる
                          
                          **中級者が追加で意識すべきこと**
                          
                          4. %帯別の警戒技
                             - 0-50%: 下投げコンボ
                             - 50-100%: 空後、上スマ
                             - 100%以上: 上スマ、後ろ投げ、空後
                          
                          5. 着地狩りの徹底
                             - マリオを浮かせたら、地上に戻させない
                             - 着地点を先読みして技を置く
                          
                          **上級者向け**
                          
                          6. 読み合いの深化
                             - マリオの癖（ガーキャン多用、NB依存など）を見抜く
                             - 同じ対策ばかりせず、パターンを変える
                          
                          段階的な学習パスを示すことで、
                          初心者から上級者まで役立つ情報になります。"
```

**理由**:
- 優先度順の提示（初心者がまず何をすべきか明確）
- 段階的な学習パス（初心者→中級者→上級者）
- 「まずはこれだけ」という絞り込みが親切

---

## 🎯 理想的なフィードバックフォーマット

### フォーマット1: 要素別（シンプル）

```
/teach_element question:"[質問]" 
               element_number:[1-4] 
               correction:"[問題点]
                          
                          [改善内容]
                          
                          [理由]"
```

### フォーマット2: パターン学習用（高度）

```
/teach question:"[質問]"
       correction:"【現状の問題】
                   [何が不足しているか]
                   
                   【理想的な回答】
                   [完全な回答例]
                   
                   【学習させたいパターン】
                   [このタイプの質問には常に〜を含めるべき]
                   
                   【例】
                   キャラ対策の質問には:
                   1. 相手の強み + 数値データ
                   2. 具体的な対処技（3つ以上）
                   3. キャラ別の技選択
                   4. %帯別の注意点
                   5. 初心者向けの優先順位"
```

---

## 💡 この回答への推奨フィードバック（優先順位順）

### 優先度1: [2]技術的解説の計算式追加
- **効果**: 高（技術的理解の深化）
- **DSPy学習効果**: 高（「技術解説には計算式」を学習）
- 上記の改善案2を使用

### 優先度2: [3]具体的な技選択の追加
- **効果**: 高（実用性の向上）
- **DSPy学習効果**: 高（「実戦では具体例3つ以上」を学習）
- 上記の改善案3を使用

### 優先度3: [1]数値データの拡充
- **効果**: 中（情報の完全性）
- **DSPy学習効果**: 中
- 上記の改善案1を使用

### 優先度4: [4]段階的な学習パスの追加
- **効果**: 中（初心者への配慮）
- **DSPy学習効果**: 中
- 上記の改善案4を使用

---

## 🚀 フィードバックの実行手順

### ステップ1: 回答を読んで評価

```
✅ 良い点を確認:
- トーンは穏やかか？
- 構造化されているか？
- 各要素が含まれているか？

❌ 改善点を特定:
- どの要素が不足しているか？
- どの要素が抽象的すぎるか？
- 計算式・具体例が欠けているか？
```

### ステップ2: フィードバックを記録

```
# 単一要素の問題 → /teach_element
/teach_element element_number:2 correction:"..."

# 複数要素の問題 → /teach
/teach correction:"..."

# トーンの問題 → /teach（対比型）
/teach correction:"【NG】... 【OK】..."
```

### ステップ3: 30件ごとに最適化

```bash
# フィードバックが30件たまったら
python -m src.utils.optimize_coach

# 履歴レポートを確認
cat data/optimization_history/$(ls -t data/optimization_history/ | head -1)
```

---

## 📊 まとめ

### この回答への推奨フィードバック

1. **[2]技術的解説**: 計算式の追加（改善案2）
2. **[3]実戦での使い方**: 技選択の具体化（改善案3）

この2つを実装することで、DSPyが以下を学習します:
- 技術解説には計算式を含める
- 実戦での使い方には具体的な技選択を3つ以上含める
- キャラ別の違いを説明する

30件のフィードバックで、これらのパターンが全ての回答に反映されるようになります。
